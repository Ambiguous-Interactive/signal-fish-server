# YAML Linting Workflow
#
# Validates all YAML files for syntax errors, formatting issues, and best practices
# using yamllint with project-specific configuration.
#
# Configuration:
#   - .yamllint.yml: YAML linting rules and exclusions
#
# Runs on:
#   - Push to main branch (only for YAML file changes)
#   - Pull requests to main (only for YAML file changes)
#
# Features:
#   - Validates YAML syntax and formatting
#   - Checks GitHub Actions workflow files
#   - Pinned yamllint version for reproducibility

name: YAML Lint

on:
  push:
    branches: [main]
    paths:
      - '**/*.yml'
      - '**/*.yaml'
      - '.yamllint.yml'
      - '.github/workflows/yaml-lint.yml'
  pull_request:
    branches: [main]
    paths:
      - '**/*.yml'
      - '**/*.yaml'
      - '.yamllint.yml'
      - '.github/workflows/yaml-lint.yml'

concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}
  cancel-in-progress: true

permissions:
  contents: read

jobs:
  yamllint:
    name: YAML Lint
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Checkout repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2

      - name: Set up Python
        uses: actions/setup-python@0b93645e9fea7318ecaed2b359559ac225c90a2b # v5.3.0
        with:
          python-version: '3.12'
          # Pip caching disabled: no requirements.txt in this Rust project.
          # yamllint install is fast (~3-5s). If optimization needed, see
          # manual caching example in other workflows.

      - name: Install yamllint
        run: pip install yamllint==1.35.1

      - name: Run yamllint
        run: yamllint -c .yamllint.yml .
